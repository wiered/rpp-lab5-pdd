cats = {
    "Дорожные знаки": {
        "Предупреждающие знаки": {
            "Назначение и расположение": (
                "Предупреждающие знаки дорожного движения предназначены для информирования водителей "
                "о приближении к опасному участку дороги, движение по которому требует принятия мер, "
                "соответствующих обстановке. Эти знаки не вносят никаких ограничений в движение "
                "автотранспорта и ничего не предписывают — их основная функция заключается в том, чтобы "
                "заранее предупредить водителя об имеющейся опасности и указать на её характер. "
                "Предупреждающие знаки треугольной формы устанавливаются заблаговременно: в населенном "
                "пункте на расстоянии 50-100 метров до начала опасного участка, а вне населённого пункта — "
                "на расстоянии 150-300 метров. При необходимости знаки могут устанавливаться на ином "
                "расстоянии, которое в этом случае указывается на дополнительной табличке 8.1.1 «Расстояние до объекта». "
            ),
            "Типовые знаки опасности": (
                "Большинство предупреждающих знаков имеют стандартную треугольную форму с белым фоном и "
                "красным ободком, а символы на них обычно выполняются чёрного цвета. Всего существует 34 "
                "основных предупреждающих знака, причём некоторые из них имеют несколько разновидностей. "
                "К наиболее распространённым относятся знаки железнодорожного переезда, пешеходного перехода, "
                "детей, сужения дороги, опасных поворотов и пересечения с круговым движением. "
                "В местах производства дорожных работ предупреждающие знаки могут иметь жёлтый фон вместо "
                "белого — такие знаки называются временными. В случаях если значения временных дорожных "
                "знаков и стационарных дорожных знаков противоречат друг другу, водители должны руководствоваться временными знаками."
            ),
            "Как действовать при виде знака": (
                "При появлении предупреждающего знака водитель должен повысить внимание и принять меры, "
                "соответствующие характеру предупреждения. Чаще всего это означает необходимость снизить "
                "скорость движения и подготовиться к возможным изменениям дорожной обстановки. Важно понимать, "
                "что предупреждающие знаки дают водителю дополнительное время на принятие правильного решения, "
                "которое поможет избежать ДТП. Хотя сами предупреждающие знаки не устанавливают конкретных "
                "ограничений, игнорирование их может привести к нарушению других требований ПДД и, как следствие, к штрафам. "
                "Например, непропуск пешеходов на переходе после знака «Пешеходный переход» влечёт штраф 1500-2500 рублей, "
                "а проезд на красный сигнал светофора после знака «Светофорное регулирование» — штраф 1500 рублей."
            ),
            "test": {
                "Какова основная функция предупреждающих знаков?": {
                    "answers": [
                        "A) Ограничивать скорость движения",
                        "B) Предписывать порядок движения",
                        "C) Информировать водителей об опасности и её характере",
                        "D) Регулировать движение светофором",
                    ],
                    "correct": "C"
                },
                "На каком расстоянии в населённом пункте обычно устанавливают предупреждающий знак перед опасным участком?": {
                    "answers": [
                        "A) 30–50 м",
                        "B) 50–100 м",
                        "C) 150–300 м",
                        "D) 400–600 м",
                    ],
                    "correct": "B"
                },
                "Сколько основных предупреждающих знаков предусмотрено Правилами дорожного движения?": {
                    "answers": [
                        "A) 12",
                        "B) 34",
                        "C) 50",
                        "D) 72",
                    ],
                    "correct": "B"
                },
                "Если значения временных (жёлтый фон) и стационарных предупреждающих знаков противоречат друг другу, какими знаками должен руководствоваться водитель?": {
                    "answers": [
                        "A) Стационарными",
                        "B) Временными",
                        "C) Ближайшими по расположению",
                        "D) Любым из них на своё усмотрение",
                    ],
                    "correct": "B"
                },
                "Какое действие чаще всего требуется от водителя при появлении предупреждающего знака?": {
                    "answers": [
                        "A) Увеличить скорость",
                        "B) Снизить скорость и повысить внимание",
                        "C) Включить дальний свет",
                        "D) Немедленно перестроиться в левый ряд",
                    ],
                    "correct": "B"
                },
                "Каков размер штрафа за непропуск пешеходов на переходе после знака «Пешеходный переход»?": {
                    "answers": [
                        "A) 500–1000 рублей",
                        "B) 1000–1500 рублей",
                        "C) 1500–2500 рублей",
                        "D) 3000–5000 рублей",
                    ],
                    "correct": "C"
                }
            }
        },
        "Запрещающие и предписывающие знаки": {
            "Запрещающие: ограничения движения": (
                "Запрещающие знаки вводят или отменяют определенные ограничения движения и имеют круглую форму "
                "с белым фоном и красной окантовкой. Наиболее распространённые из них — знак 3.1 «Въезд запрещён» "
                "(в народе «кирпич»), который запрещает въезд всех транспортных средств в данном направлении, "
                "и знак 3.2 «Движение запрещено» («бублик»), запрещающий движение всех транспортных средств во всех направлениях. "
                "Большинство запрещающих знаков имеют исключения для определённых категорий транспорта: маршрутные транспортные средства, "
                "автомобили инвалидов с соответствующим знаком, транспорт предприятий, обслуживающих данную территорию, "
                "и автомобили жителей или работников зоны действия знака. Нарушение требований запрещающих знаков влечёт административную "
                "ответственность от предупреждения до штрафа 5000 рублей в зависимости от конкретного нарушения."
            ),
            "Предписывающие: обязательные действия": (
                "Предписывающие знаки не накладывают ограничений, а наоборот, требуют выполнения конкретных манёвров и показывают "
                "направление, скорость и вид транспорта, который может продолжить движение. Они имеют круглую форму с синим фоном "
                "и белыми символами, обязывая водителей строго соблюдать указанные направления и способы движения. "
                "Особое внимание заслуживает знак 4.1.1 «Движение прямо», действие которого зависит от места установки: если он "
                "установлен перед перекрёстком, то запрещает повороты только на данном пересечении, а если в начале участка дороги — "
                "действует до ближайшего перекрёстка, при этом разрешая повороты направо во дворы и на прилегающие территории. "
                "Нарушение предписывающих знаков влечёт предупреждение или штраф 500 рублей, но при выезде на встречную полосу наказание "
                "ужесточается до 5000 рублей или лишения прав на 4-6 месяцев."
            ),
            "Знаки приоритета": (
                "Знаки приоритета устанавливают очерёдность проезда перекрёстков, пересечений проезжих частей или узких участков дороги. "
                "В отличие от других групп дорожных знаков, они не имеют единой формы или цветовой гаммы — знак 2.1 «Главная дорога» выполнен "
                "в виде жёлтого ромба с белой каймой, знак 2.4 «Уступите дорогу» представляет собой перевёрнутый белый треугольник с красной окантовкой, "
                "а знак 2.5 «Движение без остановки запрещено» имеет форму красного восьмиугольника с надписью STOP. Основная функция знаков приоритета — "
                "предотвращение конфликтных ситуаций на перекрёстках путём чёткого определения, кто имеет преимущество проезда. Нарушение требований знаков "
                "приоритета влечёт штрафы от 750 до 5000 рублей в зависимости от конкретного нарушения: непропуск транспорта с преимуществом карается штрафом "
                "1000 рублей, а нарушение требований знака «STOP» на железнодорожном переезде — 5000 рублей."
            ),
            "test": {
                "Какой знак запрещает въезд всех транспортных средств только в данном направлении?": {
                    "answers": [
                        "A) 2.5 «Движение без остановки запрещено»",
                        "B) 3.1 «Въезд запрещён» («кирпич»)",
                        "C) 3.2 «Движение запрещено» («бублик»)",
                        "D) 4.1.1 «Движение прямо»",
                    ],
                    "correct": "B"
                },
                "Каков максимальный размер штрафа за нарушение требований запрещающих знаков?": {
                    "answers": [
                        "A) 500 руб.",
                        "B) 1 000 руб.",
                        "C) 3 000 руб.",
                        "D) 5 000 руб.",
                    ],
                    "correct": "D"
                },
                "Какого цвета фон и форма у большинства предписывающих знаков?": {
                    "answers": [
                        "A) Белый треугольник",
                        "B) Жёлтый ромб",
                        "C) Синий круг",
                        "D) Красный восьмиугольник",
                    ],
                    "correct": "C"
                },
                "Если знак 4.1.1 «Движение прямо» установлен в начале участка дороги (а не прямо перед перекрёстком), какие манёвры разрешены?": {
                    "answers": [
                        "A) Только движение прямо до конца участка, без каких-либо поворотов",
                        "B) Движение прямо, а также повороты направо во дворы и на прилегающие территории",
                        "C) Повороты направо и налево на любом перекрёстке",
                        "D) Любой манёвр, кроме разворота",
                    ],
                    "correct": "B"
                },
                "Какова основная функция знаков приоритета?": {
                    "answers": [
                        "A) Ограничивать скорость на опасных участках",
                        "B) Указывать обязательное направление движения",
                        "C) Определять очерёдность проезда и предотвращать конфликтные ситуации",
                        "D) Запрещать въезд определённым видам транспорта",
                    ],
                    "correct": "C"
                },
                "Какой штраф предусмотрен за нарушение требований знака 2.5 «Движение без остановки запрещено» (STOP) на железнодорожном переезде?": {
                    "answers": [
                        "A) 750 руб.",
                        "B) 1 000 руб.",
                        "C) 3 000 руб.",
                        "D) 5 000 руб.",
                    ],
                    "correct": "D"
                }
            }
        }
    },
    "Разметка и сигналы": {
        "Горизонтальная и вертикальная разметка": {
            "Горизонтальная разметка: линии и их значение": (
                "Горизонтальная разметка представляет собой линии, стрелы, надписи и другие обозначения на проезжей части, "
                "которые устанавливают определенные режимы и порядок движения. Она подразделяется на постоянную (белого цвета) и "
                "временную (оранжевого цвета), при этом некоторые виды разметки могут иметь жёлтый цвет для обозначения мест запрещённой "
                "стоянки или остановки. Основные типы включают сплошные линии (разметка 1.1), которые запрещено пересекать и которые "
                "разделяют транспортные потоки противоположных направлений, а также прерывистые линии, позволяющие совершать манёвры "
                "при безопасности движения.\n\n"
                "Особое внимание следует уделить приоритету разметки: если временная разметка противоречит постоянной, водители должны "
                "руководствоваться временной разметкой, а если линии разметки противоречат дорожным знакам, приоритет отдается знакам. "
                "Горизонтальная разметка также включает стрелки направления движения по полосам, обозначения пешеходных переходов типа «зебра», "
                "стоп-линии на перекрёстках и специальные символы для регулирования движения различных категорий транспорта."
            ),
            "Вертикальная разметка и ограждения": (
                "Вертикальная разметка представляет собой сочетание чёрных и белых полос на дорожных сооружениях и элементах оборудования дорог, "
                "которая показывает их габариты и служит средством зрительного ориентирования. Основная цель такой разметки — обозначить элементы "
                "дорожной инфраструктуры, которые представляют опасность для движущихся транспортных средств, включая опоры мостов, путепроводов, "
                "торцовые части парапетов, направляющие столбики и ограждения. Важно помнить, что соприкасаться с объектами, обозначенными вертикальной "
                "разметкой, строго запрещено, поскольку они представляют серьёзную опасность для безопасности движения.\n\n"
                "Различные виды вертикальной разметки применяются в зависимости от типа дорожного сооружения: разметка 2.1.1-2.1.3 обозначает опасные "
                "вертикальные элементы, разметка 2.2 — нижний край пролётных строений мостов и тоннелей, разметка 2.3 — круглые тумбы на разделительных полосах, "
                "а разметка 2.5-2.7 — различные типы ограждений и бордюров. Для улучшения видимости в тёмное время суток в краску вертикальной разметки "
                "добавляют светоотражающие компоненты, что делает её заметной при освещении фарами автомобиля."
            ),
            "test": {
                "Какой цвет используют для временной горизонтальной разметки?": {
                    "answers": [
                        "A) Белый",
                        "B) Жёлтый",
                        "C) Оранжевый",
                        "D) Синий",
                    ],
                    "correct": "C"
                },
                "Если временная горизонтальная разметка противоречит постоянной, чем должен руководствоваться водитель?": {
                    "answers": [
                        "A) Постоянной разметкой",
                        "B) Временной разметкой",
                        "C) Дорожными знаками",
                        "D) Сигналами светофора",
                    ],
                    "correct": "B"
                },
                "Какова основная комбинация цветов вертикальной разметки, обозначающей опасные элементы дорожных сооружений?": {
                    "answers": [
                        "A) Чёрно-белые полосы",
                        "B) Бело-красные полосы",
                        "C) Жёлто-чёрные ромбы",
                        "D) Сплошная белая линия",
                    ],
                    "correct": "A"
                },
                "Какая вертикальная разметка применяется для обозначения нижнего края пролётных строений мостов и тоннелей?": {
                    "answers": [
                        "A) 2.1",
                        "B) 2.2",
                        "C) 2.3",
                        "D) 2.5",
                    ],
                    "correct": "B"
                }
            }
        },
        "Светофоры и регулировщик": {
            "Сигналы светофора: основные и дополнительные секции": (
                "Светофоры с круглыми сигналами могут иметь одну или две дополнительные секции с сигналами в виде зеленой стрелки, "
                "которые располагаются на уровне зеленого круглого сигнала. Основные сигналы светофора имеют стандартные значения: зеленый "
                "разрешает движение, желтый предупреждает о скорой смене сигнала, красный запрещает движение, а сочетание красного и желтого "
                "информирует о скором включении зеленого сигнала. Дополнительные секции служат для регулирования движения в определенных направлениях "
                "и позволяют более эффективно управлять транспортными потоками на сложных перекрестках.\n\n"
                "Включенная зеленая стрелка в дополнительной секции разрешает движение в направлении стрелки независимо от цвета включенного основного "
                "сигнала. Однако при движении по зеленой стрелке в дополнительной секции совместно с красным основным сигналом водитель обязан уступить "
                "дорогу транспортным средствам, движущимся с других направлений. Выключенный сигнал дополнительной секции или включенный световой "
                "сигнал красного цвета её контура означает запрещение движения в направлении, регулируемом этой секцией."
            ),
            "Жесты регулировщика": (
                "Регулировщик является главным участником дорожного движения, и его сигналы имеют приоритет над сигналами светофоров и дорожными знаками. "
                "Основные жесты регулировщика включают три положения: руки вытянуты в стороны или опущены вниз, правая рука вытянута вперед, и рука поднята вверх. "
                "Когда руки регулировщика вытянуты в стороны или опущены вниз, движение разрешено со стороны левого и правого бока прямо и направо, а со стороны груди "
                "и спины движение запрещено для всех транспортных средств.\n\n"
                "При вытянутой вперед правой руке регулировщика движение разрешено только тем транспортным средствам, на которые указывает рука, причем они могут двигаться "
                "только направо, а транспорт слева от регулировщика может двигаться во всех направлениях. Поднятая вверх рука регулировщика означает запрещение движения "
                "для всех участников дорожного движения во всех направлениях, этот жест аналогичен желтому сигналу светофора и предупреждает о смене сигнала."
            ),
            "test": {
                "Что означает включённая зелёная стрелка в дополнительной секции при одновременном красном основном сигнале?": {
                    "answers": [
                        "A) Движение запрещено во всех направлениях",
                        "B) Разрешено движение в направлении стрелки без уступки",
                        "C) Разрешено движение в направлении стрелки при условии уступить дорогу остальным",
                        "D) Разрешено движение во всех направлениях",
                    ],
                    "correct": "C"
                },
                "Что означает выключенная дополнительная секция со стрелкой или включённый красный контур её сигнала?": {
                    "answers": [
                        "A) Разрешает движение в направлении стрелки",
                        "B) Запрещает движение в направлении стрелки",
                        "C) Требует остановки, но допускает поворот направо",
                        "D) Предупреждает о скорой смене сигнала",
                    ],
                    "correct": "B"
                },
                "Чьи сигналы имеют приоритет, если противоречат сигналам светофора и дорожным знакам?": {
                    "answers": [
                        "A) Сигналы светофора",
                        "B) Дорожные знаки",
                        "C) Сигналы регулировщика",
                        "D) Горизонтальная разметка",
                    ],
                    "correct": "C"
                },
                "Какое значение имеет жест регулировщика с поднятой вверх рукой?": {
                    "answers": [
                        "A) Разрешает движение прямо и направо со стороны левого и правого бока",
                        "B) Запрещает движение для всех участников во всех направлениях",
                        "C) Разрешает движение только тем, на кого указывает рука",
                        "D) Разрешает поворот направо со всех направлений",
                    ],
                    "correct": "B"
                }
            }
        }
    },
    "Перекрёстки и маневрирование": {
        "Перекрёстки": {
            "Типы перекрёстков и знаки приоритета": (
                "Перекрёстки подразделяются на регулируемые и нерегулируемые в зависимости от способа управления движением. "
                "Регулируемым считается перекрёсток, где очерёдность проезда определяется сигналами светофора или регулировщика, при этом "
                "знаки приоритета на таких пересечениях не действуют. Нерегулируемые перекрёстки, в свою очередь, делятся на равнозначные "
                "(где все дороги имеют одинаковый статус) и неравнозначные (где есть главная и второстепенная дороги).\n\n"
                "Знаки приоритета устанавливают очерёдность проезда перекрёстков и пересечений проезжих частей. Основными являются знак 2.1 "
                "«Главная дорога» в виде жёлтого ромба с белой каймой, предоставляющий преимущество проезда нерегулируемых перекрёстков, знак 2.4 "
                "«Уступите дорогу» в форме перевёрнутого белого треугольника с красной окантовкой и знак 2.5 «Движение без остановки запрещено» "
                "в виде красного восьмиугольника с надписью STOP. При отсутствии знаков приоритета дорога с твёрдым покрытием считается главной "
                "по отношению к грунтовой дороге."
            ),
            "Правило «помехи справа»": (
                "Правило «помехи справа» представляет собой народное выражение пункта 8.9 ПДД, который гласит: «В случаях, "
                "когда траектории движения транспортных средств пересекаются, а очерёдность проезда не оговорена Правилами, дорогу "
                "должен уступить водитель, к которому транспортное средство приближается справа». Это правило применяется только в двух "
                "ситуациях: при одновременном перестроении транспортных средств, движущихся попутно, и на нерегулируемых перекрёстках "
                "равнозначных дорог, где другие правила приоритета не действуют.\n\n"
                "Важно понимать, что правило «помехи справа» является последним в иерархии правил дорожного движения и применяется "
                "только тогда, когда траектории движения пересекаются, транспортные средства равнозначны, и нет других регулирующих факторов. "
                "Оно не действует при наличии знаков приоритета, работающего светофора, регулировщика, при движении по разным типам покрытия "
                "или когда один из участников движется по своей полосе без перестроения. Нарушение этого правила влечёт административную "
                "ответственность в зависимости от конкретной ситуации."
            ),
            "Проезд нерегулируемого перекрёстка": (
                "На нерегулируемых перекрёстках неравнозначных дорог водитель, движущийся по второстепенной дороге, обязан уступить дорогу "
                "всем транспортным средствам, приближающимся по главной дороге, независимо от направления их дальнейшего движения. При этом "
                "водители, находящиеся на главной дороге, имеют преимущество, но при повороте налево или развороте должны уступить дорогу встречному "
                "транспорту, также движущемуся по главной дороге. Если главная дорога меняет направление на перекрёстке, водители руководствуются "
                "знаками приоритета и дополнительными табличками, показывающими направление главной дороги.\n\n"
                "На нерегулируемых перекрёстках равнозначных дорог действует правило «помехи справа»: водители обязаны уступать дорогу транспортным "
                "средствам, приближающимся справа. При этом все участники движения должны соблюдать общие требования: уступать дорогу пешеходам при "
                "поворотах, не выезжать на перекрёсток при образовавшемся за ним заторе, и помнить, что трамвай имеет преимущество перед нерельсовыми "
                "транспортными средствами на равнозначных дорогах. Особое внимание следует уделять круговым перекрёсткам, где преимущество предоставляется "
                "транспортным средствам, уже движущимся по кругу."
            ),
            "test": {
                "Что задаёт очерёдность проезда регулируемого перекрёстка?": {
                    "answers": [
                        "A) Правило «помехи справа»",
                        "B) Сигналы светофора или регулировщика",
                        "C) Знаки приоритета",
                        "D) Вид дорожного покрытия",
                    ],
                    "correct": "B"
                },
                "Как выглядит знак 2.1 «Главная дорога», предоставляющий преимущество на нерегулируемом перекрёстке?": {
                    "answers": [
                        "A) Жёлтый ромб с белой каймой",
                        "B) Красный восьмиугольник с надписью STOP",
                        "C) Перевёрнутый белый треугольник с красной окантовкой",
                        "D) Синий круг со стрелкой",
                    ],
                    "correct": "A"
                },
                "Правило «помехи справа» применяется, когда…": {
                    "answers": [
                        "A) Перекрёсток регулируется светофором",
                        "B) Установлены знаки приоритета",
                        "C) Перекрёсток нерегулируемый и равнозначный",
                        "D) Дороги имеют разное покрытие",
                    ],
                    "correct": "C"
                },
                "В каком из перечисленных случаев не действует правило «помехи справа»?": {
                    "answers": [
                        "A) При одновременном перестроении в соседнюю полосу",
                        "B) На равнозначном перекрёстке без знаков",
                        "C) При наличии работающего светофора",
                        "D) При встрече двух легковых автомобилей на грунтовой дороге",
                    ],
                    "correct": "C"
                },
                "На нерегулируемом перекрёстке неравнозначных дорог водитель, движущийся по второстепенной дороге, должен…": {
                    "answers": [
                        "A) Проехать первым, если поворачивает направо",
                        "B) Уступить дорогу всем, кто едет по главной, независимо от их направления",
                        "C) Уступить только тем, кто поворачивает налево",
                        "D) Уступить, только если движется с меньшей скоростью",
                    ],
                    "correct": "B"
                },
                "Кому предоставляется преимущество на перекрёстке с круговым движением без светофора?": {
                    "answers": [
                        "A) Транспортным средствам, въезжающим на круг",
                        "B) Трамваю, если он первым подъехал",
                        "C) Транспортным средствам, уже движущимся по кругу",
                        "D) Тем, кто движется по левой полосе",
                    ],
                    "correct": "C"
                }
            }
        },
        "Обгон и перестроение": {
            "Правила обгона": (
                "Обгон представляет собой опережение одного или нескольких транспортных средств, связанное с выездом на полосу встречного движения "
                "и последующим возвращением на ранее занимаемую полосу. Перед началом обгона водитель обязан убедиться в том, что полоса движения, "
                "на которую он собирается выехать, свободна на достаточном для обгона расстоянии и в процессе обгона он не создаст опасности для "
                "движения и помех другим участникам дорожного движения. Водителю запрещается выполнять обгон, если транспортное средство впереди "
                "производит обгон или объезд препятствия, подало сигнал поворота налево, следующее за ним транспортное средство начало обгон, "
                "или по завершении обгона он не сможет безопасно вернуться на ранее занимаемую полосу.\n\n"
                "Обгон запрещается на регулируемых перекрестках, на нерегулируемых перекрестках при движении по дороге, не являющейся главной, на "
                "пешеходных переходах, на железнодорожных переездах и ближе чем за 100 метров перед ними, на мостах, путепроводах, эстакадах и под ними, "
                "а также в тоннелях, в конце подъема, на опасных поворотах и на других участках с ограниченной видимостью. Водитель обгоняемого транспортного "
                "средства не должен препятствовать обгону посредством повышения скорости движения или иными действиями."
            ),
            "Безопасное перестроение": (
                "При перестроении водитель должен уступить дорогу транспортным средствам, движущимся в попутном направлении по той полосе, на которую "
                "он намерен перестроиться. При одновременном перестроении транспортных средств, движущихся в одном направлении, водитель, который находится "
                "слева, должен уступить дорогу транспортному средству, находящемуся справа — действует правило «помехи справа». Перед перестроением обязательно "
                "нужно включать сигнал поворота и убедиться через зеркала заднего вида, что маневр будет безопасным.\n\n"
                "Особое внимание следует уделять «мертвой зоне» — ситуации, при которой объект исчез из бокового зеркала заднего вида, но еще не появился в боковом окне. "
                "При перестроении в плотном потоке необходимо сначала ускориться до скорости движения автомобилей в соседнем ряду, наметить окошко между автомобилями, "
                "включить указатель поворота и плавно перестроиться между автомобилями. Никогда не следует менять две полосы движения за один прием, так как это не позволяет "
                "адекватно оценить дорожную ситуацию."
            ),
            "Ответственность за опасные манёвры": (
                "Опасное вождение включает в себя невыполнение требований ПДД при перестроении, перестроение при интенсивном движении когда все полосы заняты, несоблюдение "
                "безопасной дистанции и бокового интервала, резкое торможение без объективных причин и препятствование обгону. С 2025 года за опасное вождение, включая необоснованное "
                "перестроение и резкое торможение, предусмотрен штраф от 3000 до 5000 рублей, а за повторное нарушение — лишение прав на срок от одного до трех месяцев.\n\n"
                "В настоящее время нарушения правил маневрирования наказываются по статье 12.14 КоАП РФ: невыполнение требования подать сигнал перед перестроением влечёт предупреждение "
                "или штраф 500 рублей, а невыполнение требования уступить дорогу транспортному средству с преимущественным правом движения — предупреждение или штраф 500 рублей. Перестроение "
                "с «подрезанием» наказывается штрафом 500 рублей, а несоблюдение дистанции и интервалов, необоснованные перестроения и препятствование обгону — штрафом 1500 рублей."
            ),
            "test": {
                "Что такое обгон согласно ПДД?": {
                    "answers": [
                        "A) Опережение без выезда из своей полосы",
                        "B) Опережение с выездом на встречную полосу и возвращением на прежнюю",
                        "C) Любое опережение справа",
                        "D) Разворот через встречную полосу",
                    ],
                    "correct": "B"
                },
                "На каком из перечисленных участков обгон запрещён?": {
                    "answers": [
                        "A) На прямом участке загородной дороги",
                        "B) На регулируемом перекрёстке",
                        "C) После завершения подъёма на эстакаду",
                        "D) На участке с четырьмя полосами в одном направлении",
                    ],
                    "correct": "B"
                },
                "При одновременном перестроении двух автомобилей в одном направлении, кто должен уступить дорогу?": {
                    "answers": [
                        "A) Тот, кто находится справа",
                        "B) Тот, кто находится слева",
                        "C) Тот, кто двигается быстрее",
                        "D) Оба обязаны остановиться",
                    ],
                    "correct": "B"
                },
                "Какое из действий является ошибочным при перестроении в плотном потоке?": {
                    "answers": [
                        "A) Увеличить скорость до скорости соседней полосы",
                        "B) Включить указатель поворота",
                        "C) Перестраиваться сразу через две полосы одним приёмом",
                        "D) Проверить «мертвую зону» перед манёвром",
                    ],
                    "correct": "C"
                },
                "Каков размер штрафа за опасное вождение (необоснованное перестроение, резкое торможение) с 2025 года при первом нарушении?": {
                    "answers": [
                        "A) 500 руб.",
                        "B) 1 000 руб.",
                        "C) 3 000 – 5 000 руб.",
                        "D) Лишение прав на 1–3 месяца",
                    ],
                    "correct": "C"
                },
                "Какое наказание предусмотрено за невключение сигнала поворота перед перестроением по статье 12.14 КоАП РФ?": {
                    "answers": [
                        "A) Предупреждение или штраф 500 руб.",
                        "B) Штраф 1 500 руб.",
                        "C) Лишение прав на 1 месяц",
                        "D) Штраф 3 000 руб.",
                    ],
                    "correct": "A"
                }
            }
        }
    },
    "Ответственность и безопасность": {
        "Административная ответственность": {
            "Основные штрафы 2025 года": (
                "В 2025 году размеры административных штрафов за нарушения ПДД остаются на уровне предыдущих лет с учетом индексации. "
                "Наиболее распространенные нарушения включают превышение скорости: на 20-40 км/ч штраф составляет 500 рублей, на 40-60 км/ч — "
                "1000-1500 рублей, на 60-80 км/ч — 2000-2500 рублей или лишение прав на 4-6 месяцев, а за превышение более чем на 80 км/ч "
                "предусмотрен штраф 5000 рублей или лишение прав на 6 месяцев. Нарушения правил остановки и стоянки наказываются штрафами от "
                "1000 до 3000 рублей в зависимости от места и характера нарушения, при этом в Москве и Санкт-Петербурге размеры штрафов увеличены.\n\n"
                "Особое внимание уделяется безопасности пешеходов: непропуск пешехода на переходе влечет штраф 1500-2500 рублей, проезд на красный "
                "свет — 1000 рублей, а повторное нарушение — 5000 рублей или лишение прав на 4-6 месяцев. За управление транспортным средством в "
                "состоянии алкогольного опьянения предусмотрен штраф 30000 рублей и лишение прав на 1,5-2 года, а за отказ от медицинского освидетельствования "
                "— аналогичное наказание. Использование телефона за рулем без hands-free наказывается штрафом 1500 рублей."
            ),
            "Лишение права управления": (
                "Лишение водительских прав является самым суровым административным наказанием и назначается исключительно по решению суда за грубые нарушения ПДД. "
                "Максимальный срок лишения составляет 3 года, при этом если водитель продолжает управлять транспортным средством без прав, срок может быть увеличен. "
                "Наиболее серьезные нарушения, влекущие лишение прав на 1,5-2 года, включают управление в состоянии опьянения, передачу управления лицу в состоянии "
                "опьянения, отказ от медицинского освидетельствования и употребление алкоголя после ДТП до освидетельствования.\n\n"
                "За нарушения средней тяжести предусмотрено лишение прав на срок от 4 месяцев до 1 года: превышение скорости на 60-80 км/ч (4-6 месяцев), выезд на встречную "
                "полосу (4-6 месяцев), повторный проезд на красный свет (4-6 месяцев), движение против направления по односторонней дороге (4-6 месяцев). Минимальные сроки лишения "
                "от 1 до 3 месяцев применяются за управление без номеров, с поддельными номерами, неоднократное управление незарегистрированным транспортным средством и непредоставление "
                "преимущества автомобилям экстренных служб. После вынесения судебного решения водитель обязан в течение трех дней сдать права в отделение ГИБДД."
            ),
            "test": {
                "Каков размер штрафа за превышение скорости на 20–40 км/ч в 2025 году?": {
                    "answers": [
                        "A) 500 рублей",
                        "B) 1 000–1 500 рублей",
                        "C) 2 000–2 500 рублей",
                        "D) Лишение прав на 4–6 месяцев",
                    ],
                    "correct": "A"
                },
                "Какое наказание предусмотрено за использование телефона за рулём без hands-free?": {
                    "answers": [
                        "A) 500 рублей",
                        "B) 1 500 рублей",
                        "C) 3 000–5 000 рублей",
                        "D) Лишение прав на 4–6 месяцев",
                    ],
                    "correct": "B"
                },
                "Максимальный срок лишения права управления транспортным средством, предусмотренный КоАП РФ, составляет…": {
                    "answers": [
                        "A) 1 год",
                        "B) 2 года",
                        "C) 3 года",
                        "D) 5 лет",
                    ],
                    "correct": "C"
                },
                "На какой срок лишают водительских прав за управление в состоянии опьянения?": {
                    "answers": [
                        "A) 1–3 месяца",
                        "B) 4–6 месяцев",
                        "C) 1,5–2 года",
                        "D) 3 года",
                    ],
                    "correct": "C"
                }
            }
        },
        "Безопасность и первая помощь": {
            "Ремни и детские удерживающие устройства": (
                "Применение ремней безопасности в автомобиле является обязательным без исключений для водителя и всех пассажиров транспортного средства, включая детей, перевозка которых осуществляется в специальных детских креслах. Ремни безопасности защищают от ударов грудной клеткой о руль при резком торможении, от сотрясения мозга и травм позвоночника при лобовом столкновении, от ударов о боковые стойки при боковом столкновении и от переломов шейного отдела при ударе сзади. Правильное использование ремня предполагает расположение верхней лямки через плечо и грудную клетку, а не под рукой или около шеи, при этом нижний ремень должен удерживать бедра, а не живот. За непристегнутого водителя предусмотрен штраф 1000 рублей, а за каждого непристегнутого пассажира — 500 рублей.\n\n"
                "Перевозка детей в возрасте до 11 лет включительно в легковом автомобиле должна осуществляться с использованием детских удерживающих систем, соответствующих весу и росту ребенка. Детские удерживающие устройства должны соответствовать европейскому стандарту ECE 44 или новому стандарту ECE 129, что подтверждается обязательным сертификатом соответствия. Для детей до 7 лет использование детских удерживающих устройств является безапелляционным требованием, а с 7 до 11 лет на заднем сиденье допускается использование обычных ремней безопасности, но на переднем сиденье детское кресло остается обязательным. За нарушение правил перевозки детей предусмотрен штраф 3000 рублей."
            ),
            "Алгоритм первой помощи при ДТП": (
                "При оказании первой помощи пострадавшим в ДТП необходимо сначала убедиться в отсутствии опасности для себя, пострадавшего и окружающих, затем определить количество пострадавших и вызвать экстренные службы по номерам 112 или 103. Первоочередной задачей является оценка наличия сознания у пострадавшего: окликните его, аккуратно встряхните за плечи и громко спросите о самочувствии. Если пострадавший находится в сознании, следует получить его согласие на оказание помощи, а если без сознания — громко звать на помощь и вызывать скорую.\n\n"
                "Следующим этапом является определение наличия дыхания, которое проверяется одновременно с проверкой сознания. При наличии дыхания необходимо выполнить поворот пострадавшего в стабильное боковое положение, а если дыхание отсутствует или нарушено — начинать компрессии грудной клетки с глубиной не менее 5 см и частотой не менее 100 в минуту. При извлечении пострадавшего из автомобиля следует помнить, что это допустимо только при наличии угрозы для жизни (запах бензина, задымление) или невозможности оказания помощи в текущих условиях. В остальных случаях необходимо дождаться приезда скорой медицинской помощи и других служб."
            ),
            "Действия при ДТП": (
                "Сразу после ДТП необходимо остановить транспортное средство, включить аварийную сигнализацию и выставить знак аварийной остановки на расстоянии не менее 15 метров в населенном пункте и не менее 30 метров вне населенного пункта. Перед выходом из автомобиля следует надеть светоотражающий жилет, заглушить двигатель и убрать ключи в карман. Первоочередной задачей является оценка наличия пострадавших: если есть раненые или погибшие, необходимо немедленно вызвать скорую помощь и полицию, а также оказать первую помощь до их прибытия.\n\n"
                "Если в ДТП пострадали только автомобили без человеческих жертв, следует зафиксировать на фото или видео положение транспортных средств относительно друг друга и объектов дорожной инфраструктуры, следы и предметы, относящиеся к происшествию, а также повреждения автомобилей. При отсутствии разногласий между участниками и незначительном ущербе можно оформить европротокол без вызова ГИБДД, но при наличии пострадавших, значительных повреждений или разногласий необходимо вызывать сотрудников полиции. Важно записать контактные данные свидетелей и не употреблять алкоголь до выяснения всех обстоятельств происшествия."
            ),
            "test": {
                "Какой штраф предусмотрен за непристёгнутого водителя?": {
                    "answers": [
                        "A) 500 руб.",
                        "B) 1 000 руб.",
                        "C) 3 000 руб.",
                        "D) 5 000 руб.",
                    ],
                    "correct": "B"
                },
                "Перевозка детей до какого возраста (включительно) требует обязательного применения детского удерживающего устройства на любом сиденье?": {
                    "answers": [
                        "A) До 5 лет",
                        "B) До 7 лет",
                        "C) До 11 лет",
                        "D) До 14 лет",
                    ],
                    "correct": "B"
                },
                "Какое действие выполняют первым при оказании первой помощи на месте ДТП?": {
                    "answers": [
                        "A) Проверяют наличие дыхания у пострадавшего",
                        "B) Вызывают экстренные службы",
                        "C) Убеждаются в отсутствии опасности для себя и пострадавших",
                        "D) Начинают компрессии грудной клетки",
                    ],
                    "correct": "C"
                },
                "Какова минимальная частота компрессий грудной клетки при сердечно-лёгочной реанимации у взрослого?": {
                    "answers": [
                        "A) 60 в мин",
                        "B) 80 в мин",
                        "C) 100 в мин",
                        "D) 140 в мин",
                    ],
                    "correct": "C"
                },
                "На каком расстоянии вне населённого пункта следует выставить знак аварийной остановки после ДТП?": {
                    "answers": [
                        "A) Не менее 10 м",
                        "B) Не менее 15 м",
                        "C) Не менее 30 м",
                        "D) Не менее 50 м",
                    ],
                    "correct": "C"
                },
                "Европротокол (оформление ДТП без вызова ГИБДД) допустим, если…": {
                    "answers": [
                        "A) Есть пострадавшие, но ущерб незначительный",
                        "B) Нет пострадавших и участники согласны по обстоятельствам",
                        "C) Ущерб превышает 400 000 руб.",
                        "D) Автомобили сильно повреждены, но справка из страховой уже получена",
                    ],
                    "correct": "B"
                }
            }
        }
    }
}


import asyncio
import aiohttp

API_URL = "http://127.0.0.1:8082/api"
# Если требуется аутентификация, укажите токен ниже:
TOKEN = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhIiwicm9sZSI6ImFkbWluIiwiZXhwIjoxNzQ5MDgzMDE1fQ.67sAwucx2VIOgKFxLZkVBm5Ud7LMS3Ed0ICqrYMIlnI"

# Предполагается, что dict cats уже определён в этом файле и содержит структуру категорий, подкатегорий, статей и тестов.

HEADERS = {
    "Content-Type": "application/json",
    "Authorization": f"Bearer {TOKEN}"
}

# Максимум попыток по каждому запросу
MAX_RETRIES = 5
# Базовое ожидание перед повторной попыткой (в секундах)
RETRY_DELAY = 5

async def _request_with_retries(session, method, url, **kwargs):
    """
    Вспомогательная функция: выполняет запрос session.{method}(url, **kwargs),
    при ошибке (любая непустая HTTP-ошибка или исключение) —
    ждёт RETRY_DELAY и пробует снова, до MAX_RETRIES раз.
    """
    for attempt in range(1, MAX_RETRIES + 1):
        try:
            async with getattr(session, method)(url, **kwargs) as resp:
                if resp.status >= 500:
                    text = await resp.text()
                    raise aiohttp.ClientResponseError(
                        status=resp.status,
                        message=f"Server error: {text}"
                    )
                resp.raise_for_status()
                return await resp.json()
        except Exception as e:
            if attempt < MAX_RETRIES:
                print(f"⚠ Ошибка запроса ({method.upper()} {url}): {e!r}")
                print(f"  → пробуем снова через {RETRY_DELAY} секунд (попытка {attempt}/{MAX_RETRIES})")
                await asyncio.sleep(RETRY_DELAY)
            else:
                print(f"❌ {method.upper()} {url} не удался после {MAX_RETRIES} попыток.")
                raise

async def create_category(session, title, parent_id=None):
    print(f"→ Создаём категорию: '{title}'" + (f" (parent_id={parent_id})" if parent_id else ""))
    payload = {"title": title}
    if parent_id is not None:
        payload["parent_id"] = parent_id

    data = await _request_with_retries(
        session,
        "post",
        f"{API_URL}/categories/",
        json=payload
    )
    cat_id = data["id"]
    print(f"✓ Категория '{title}' создана с id={cat_id}")
    return cat_id

async def create_article(session, category_id, title, content):
    print(f"→ Создаём статью: '{title}' (category_id={category_id})")
    payload = {
        "category_id": category_id,
        "title": title,
        "content": content,
        "content_type": "markdown"
    }
    data = await _request_with_retries(
        session,
        "post",
        f"{API_URL}/articles/",
        json=payload
    )
    art_id = data["id"]
    print(f"✓ Статья '{title}' создана с id={art_id}")
    return art_id

async def create_test_full(session, category_id, sub_title, questions_dict, max_attempts=3):
    """
    Создаёт тест вместе со всеми вопросами и вариантами одним запросом на /tests/full.
    questions_dict: {
        question_text: {
            "answers": [ "A) ...", "B) ...", ... ],
            "correct": "C"
        },
        ...
    }
    """
    test_title = f"Тест «{sub_title}»"
    print(f"→ Создаём полный тест: '{test_title}' (category_id={category_id})")

    # Формируем вложенную структуру согласно TestFullCreate
    nested_questions = []
    for question_text, q_data in questions_dict.items():
        # Вес по умолчанию 1 (если не указано иначе)
        weight = q_data.get("weight", 1)
        options_list = []
        correct_label = q_data["correct"].strip().upper()
        for ans in q_data["answers"]:
            label, sep, text = ans.partition(")")
            label = label.strip().upper()
            text = text.strip()
            is_correct = (label == correct_label)
            options_list.append({
                "text": text,
                "is_correct": is_correct
            })
        nested_questions.append({
            "text": question_text,
            "weight": weight,
            "options": options_list
        })

    payload = {
        "category_id": category_id,
        "title": test_title,
        "max_attempts": max_attempts,
        "questions": nested_questions
    }

    data = await _request_with_retries(
        session,
        "post",
        f"{API_URL}/tests/full",
        json=payload
    )
    test_id = data["id"]
    print(f"✓ Полный тест '{test_title}' создан с id={test_id}")
    return test_id

async def main():
    connector = aiohttp.TCPConnector(limit=1)  # ограничиваем до 1 одновременного соединения
    async with aiohttp.ClientSession(headers=HEADERS, connector=connector) as session:
        category_ids = {}      # title -> id
        subcategory_ids = {}   # (parent_title, sub_title) -> id

        total_cats = len(cats)
        for cat_index, (cat_title, subcats) in enumerate(cats.items(), start=1):
            print(f"\n[{cat_index}/{total_cats}] Обрабатываем категорию: '{cat_title}'")
            cat_id = await create_category(session, cat_title)
            await asyncio.sleep(2)
            category_ids[cat_title] = cat_id

            total_subs = len(subcats)
            for sub_index, (sub_title, articles_dict) in enumerate(subcats.items(), start=1):
                print(f"  [{sub_index}/{total_subs}] Обрабатываем подкатегорию: '{sub_title}'")
                sub_id = await create_category(session, sub_title, parent_id=cat_id)
                await asyncio.sleep(2)
                subcategory_ids[(cat_title, sub_title)] = sub_id

                total_items = len(articles_dict)
                for item_index, (item_title, item_value) in enumerate(articles_dict.items(), start=1):
                    print(f"    [{item_index}/{total_items}] Обрабатываем пункт: '{item_title}'")
                    if item_title == "test":
                        # Используем единый эндпоинт /tests/full для создания всего теста сразу
                        questions_dict = item_value  # это словарь вопросов
                        await create_test_full(session, sub_id, sub_title, questions_dict)
                        await asyncio.sleep(2)
                    else:
                        # Обработка статьи
                        content = item_value
                        await create_article(session, sub_id, item_title, content)
                        await asyncio.sleep(2)

if __name__ == "__main__":
    asyncio.run(main())